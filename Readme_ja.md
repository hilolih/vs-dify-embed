# dify-embed README

## 要件

### 基本機能

- 社内のDifyで提供されるAIアシスタントをVS Codeのセカンダリサイドバーに表示する拡張機能
- dify側で"http://ai.hokkaido-np.co.jp/chatbot/ghyJ5maWmgRrXo7G"のようなAIアシスタントのURLが提供されるので、それをセカンダリサイドバーにiframeで埋め込み表示する。

### アシスタント管理

- 複数のAIアシスタントを登録可能
- 各アシスタントは「名前」と「URL」のペアで管理

### UI要素

- セカンダリサイドバーの表示/非表示切り替え機能（コマンドとショートカット）
- アシスタント選択用のプルダウンメニュー
- Difyページを表示するiframe
- プルダウン選択によって表示アシスタントを切り替え

### 動作条件

- システム本部LANにいること
- 認証は不要
- ネットワークがつながらない場合はその旨を表示する。DifyのURLにアクセスできるかどうかで確認すること。
- 接続エラーが発生した場合、「リロード」ボタンをクリックして再接続を試みることができる。

### 設定項目

- `dify-embed.enable`: 拡張機能の有効/無効切り替え
- `dify-embed.urllist`: (アシスタント名,URL)の要素を持つ配列。設定画面で追加、削除が可能なこと。プルダウンにはこの変数で管理するアシスタント名を表示。

## 実装計画

### 基本構造

- VS Code拡張機能の基本構造を作成
- セカンダリサイドバーのWebViewを実装

### 設定管理

- アシスタント設定を管理するための構造設計
- 設定画面のUI実装

### UIコンポーネント

- プルダウンメニューの実装
- iframeを安全に埋め込むためのWebViewの実装
- サイドバー表示/非表示コマンドの実装

### イベント処理

- プルダウン選択イベントの処理
- iframeの読み込み状態監視

### エラーハンドリング

- 接続エラーの表示
- 不正な設定の検出と警告
